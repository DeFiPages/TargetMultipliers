{"mappings":"AACA,IAAMA,+BAGF,IAAIC,EAAiB,IAAIC,MADX,IACgCC,KAAK,aAmB9CC,WAwCIC,IACLC,MAAM,iEACDC,MAAK,SAAUC,GAIZ,OAHKA,EAASC,IACVC,QAAQC,MAAM,0CAEXH,EAASI,UAEnBL,MAAK,SAAUC,GACZ,IAAIK,EAAcC,KAAKC,MAAMP,GAC7BQ,OAAOC,QAAoBJ,GAAaK,SAAO,EACzCC,EAAKC,MACCA,EAAMC,OAASC,EAAgBC,SAC/BH,EAAMpB,kBAAkBkB,SAAQM,KAC5BA,GAAS,GACG,EACRA,EAAQ,EACHA,EAAQC,KACbD,EAAQC,IACZxB,EAAeuB,uBAjDpBL,EAAaC,EAAeM,EAAM,MACrD,MAAMC,EAAO,CACTP,MAAOA,EACPQ,QAAS,IAAIC,MAAQC,UAAYJ,GAErCK,aAAaC,QAAQb,EAAKL,KAAKmB,UAAUN,IAkDzCO,CAAc,iBAAkBpB,KAAKmB,UAAUhC,IAC/CkC,aAGKA,IACL,MAAMC,EAAS,CACXC,KAAM,MACNC,KAAM,CACFC,OAAQrC,MAAMsC,KAAK,CAAEC,OA7FnB,KA6FkC,CAAGC,EAAGC,IAAMA,EAAI,IACpDC,SAAU,CACN,CACIC,MAAO,yCACPC,gBAAiB,UACjBR,KAAMrC,MAMtB,IAAI8C,EAAIC,SAASC,eAAe,aAElB,IAAIC,MAAMH,EAAGX,IAtF1BhC,EAAAkB,IAAAA,EAAe,KACL,YAAX,cADClB,EAEM,QAAP,UAFCA,EAGW,aAAZ,eAHCA,EAIO,SAAR,WAJCA,EAKS,WAAV,aALCA,EAMK,OAAN,SANCA,EAOM,QAAP,UAmFJ+C,OAAOC,OAAM,KACT,IAAIC,WAzEelC,GACnB,MAAMmC,EAAUvB,aAAawB,QAAQpC,GAErC,IAAKmC,EACD,OAAO,KAEX,MAAM3B,EAAOb,KAAKC,MAAMuC,GAClBE,EAAM,IAAI3B,KAEhB,IACI,GAAI2B,EAAI1B,UAAYH,EAAKC,OAGrB,OADAG,aAAa0B,WAAWtC,GACjB,KAEb,MAAOR,GAEL,OADAoB,aAAa0B,WAAWtC,GACjB,KAEX,OAAOQ,EAAKP,MAsDJsC,CAAc,kBAClBL,GACApD,EAAiBa,KAAKC,MAAMsC,GAC5BlB,KAEA9B,MAtHLL,oBAAAA,kBAAiB","sources":["Documents/vscode/TargetMultipliers/src/index.ts"],"sourcesContent":["/// <reference path=\"chart.d.ts\" />\r\nmodule targetMultipliers {\r\n\r\n    const MaxTM = 57;\r\n    var tmDistribution = new Array<number>(MaxTM).fill(0);\r\n\r\n    interface Masternode {\r\n        \"ownerAuthAddress\": string,\r\n        \"operatorAuthAddress\": string,\r\n        \"rewardAddress\": string,\r\n        \"creationHeight\": number,\r\n        \"resignHeight\": number,\r\n        \"resignTx\": string,\r\n        \"banTx\": string,\r\n        \"state\": MasternodeState,\r\n        \"mintedBlocks\": number,\r\n        \"ownerIsMine\": boolean,\r\n        \"operatorIsMine\": boolean,\r\n        \"localMasternode\": boolean,\r\n        \"targetMultipliers\": number[],\r\n        \"timelock\": string\r\n    }\r\n\r\n    enum MasternodeState {\r\n        PRE_ENABLED = \"PRE_ENABLED\",\r\n        ENABLED = \"ENABLED\",\r\n        PRE_RESIGNED = \"PRE_RESIGNED\",\r\n        RESIGNED = \"RESIGNED\",\r\n        PRE_BANNED = \"PRE_BANNED\",\r\n        BANNED = \"BANNED\",\r\n        UNKNOWN = \"UNKNOWN\"\r\n    }\r\n\r\n    function setWithExpiry(key: string, value: string, ttl = 3600000) {\r\n        const item = {\r\n            value: value,\r\n            expiry: (new Date()).getTime() + ttl, //ttl in ms\r\n        }\r\n        localStorage.setItem(key, JSON.stringify(item))\r\n    }\r\n\r\n    function getWithExpiry(key: string) {\r\n        const itemStr = localStorage.getItem(key)\r\n        // if the item doesn't exist, return null\r\n        if (!itemStr) {\r\n            return null\r\n        }\r\n        const item = JSON.parse(itemStr)\r\n        const now = new Date()\r\n        // compare the expiry time of the item with the current time\r\n        try {\r\n            if (now.getTime() > item.expiry) {\r\n                // If the item is expired, delete the item from storage and return null\r\n                localStorage.removeItem(key)\r\n                return null\r\n            }\r\n        } catch (error) {\r\n            localStorage.removeItem(key)\r\n            return null\r\n        }\r\n        return item.value\r\n    }\r\n\r\n    function getTargetMultipliers() {\r\n        fetch('https://api.mydefichain.com/v1/listmasternodes/?state=Enabled')\r\n            .then(function (response) {\r\n                if (!response.ok) {\r\n                    console.error('HTTP error! status: ${response.status}');\r\n                }\r\n                return response.text();\r\n            })\r\n            .then(function (response) {\r\n                var masternodes = JSON.parse(response);\r\n                Object.entries<Masternode>(masternodes).forEach(\r\n                    ([key, value]) => {\r\n                        if (value.state == MasternodeState.ENABLED) {\r\n                            value.targetMultipliers.forEach(index => {\r\n                                index -= 1;\r\n                                if (index < 0)\r\n                                    index = 0;\r\n                                else if (index > MaxTM - 1)\r\n                                    index = MaxTM - 1;\r\n                                tmDistribution[index]++;\r\n                            });\r\n                        }\r\n                    });\r\n            }\r\n            );\r\n        setWithExpiry(\"tmDistribution\", JSON.stringify(tmDistribution));\r\n        setchart()\r\n    };\r\n\r\n    function setchart() {\r\n        const config = {\r\n            type: 'bar',\r\n            data: {\r\n                labels: Array.from({ length: MaxTM }, (_, i) => i + 1),\r\n                datasets: [\r\n                    {\r\n                        label: \"Distribution of the target multipliers\",\r\n                        backgroundColor: '#ff8000',\r\n                        data: tmDistribution\r\n                    }\r\n                ]\r\n            },\r\n        };\r\n\r\n        let e = document.getElementById('bar-chart');\r\n        //@ts-ignore\r\n        var myChart = new Chart(e, config);\r\n    }\r\n\r\n\r\n    window.onload = () => {\r\n        var s = getWithExpiry('tmDistribution');\r\n        if (s) {\r\n            tmDistribution = JSON.parse(s);\r\n            setchart();\r\n        } else {\r\n            getTargetMultipliers();\r\n        }\r\n    };\r\n\r\n}"],"names":["targetMultipliers","tmDistribution","Array","fill","MasternodeState","getTargetMultipliers","fetch","then","response","ok","console","error","text","masternodes","JSON","parse","Object","entries","forEach","key","value","state","MasternodeState1","ENABLED","index","MaxTM","ttl","item","expiry","Date","getTime","localStorage","setItem","stringify","setWithExpiry","setchart","config","type","data","labels","from","length","_","i","datasets","label","backgroundColor","e","document","getElementById","Chart","window","onload","s","itemStr","getItem","now","removeItem","getWithExpiry"],"version":3,"file":"index.c5892e74.js.map"}